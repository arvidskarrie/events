<!DOCTYPE html>
<html>
<head>
    <title>Event List</title>
</head>
<body>
    <h1>Upcoming Events</h1>
    <button id="loadEvents">Load Events</button>
    <ul id="eventList">
        <!-- List items will be inserted here -->
    </ul>

    <script>
        document.getElementById('loadEvents').addEventListener('click', function() {
            // Fetch data from the API
            fetch('http://localhost:5045/eventitems')
                .then(response => response.json())
                .then(data => {
                    // Get the event list element
                    const eventList = document.getElementById('eventList');

                    // Remove existing list items
                    eventList.innerHTML = '';

                    // Add each event as a list item
                    data.forEach(event => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `${event.id}. ${event.date}: ${event.name} - ${event.description}`; // Assuming the event object has "date", "name", and "description" properties
                        eventList.appendChild(listItem);
                    });

                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        });
    </script>

    <h1>Submit an Event</h1>

    <form id="createEventForm">
        <label for="date">Date:</label>
        <input type="text" id="date" name="Date">
        <br>

        <label for="name">Name:</label>
        <input type="text" id="name" name="Name">
        <br>

        <label for="description">Description:</label>
        <input type="text" id="description" name="Description">
        <br>

        <button type="submit">Submit</button>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('createEventForm');
            const submitButton = form.querySelector('button[type="submit"]');
            const nameInput = form.querySelector('input[name="Name"]');

            submitButton.disabled = !nameInput.value;

            nameInput.addEventListener('input', (e) => {
                submitButton.disabled = !e.target.value;
            });

            form.addEventListener('submit', async (e) => {
                e.preventDefault();

                const formData = new FormData(form);
                const eventData = Object.fromEntries(formData);

                const response = await fetch('http://localhost:5045/eventitems', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(eventData)
                });

                if (response.ok) {
                    alert('Event submitted successfully.');
                    form.reset();
                    submitButton.disabled = true;
                } else {
                    alert('Failed to submit event.');
                }
            });
        });

    </script>

    <h1>Delete an Event</h1>

    <form id="deleteEventForm">
        <label for="id">Id:</label>
        <input type="text" id="id" name="Id">

        <button type="submit">Delete</button>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('deleteEventForm');
            const deleteButton = form.querySelector('button[type="submit"]');
            const idInput = form.querySelector('input[name="Id"]');

            deleteButton.disabled = !idInput.value;
            idInput.addEventListener('input', (e) => {
                deleteButton.disabled = !e.target.value;
            });

            form.addEventListener('submit', async (e) => {
                e.preventDefault();

                const formData = new FormData(form);
                const eventData = Object.fromEntries(formData);

                const id = idInput.value;
                const response = await fetch(`http://localhost:5045/eventitems/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(eventData)
                });

                if (response.ok) {
                    alert('Event deleted successfully.');
                    form.reset();
                    deleteButton.disabled = true;
                } else {
                    alert('Failed to delete event.');
                }
            });
        });

    </script>
</body>
</html>
